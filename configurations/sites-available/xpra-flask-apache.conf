<VirtualHost *:80>
    ServerName localhost
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

	<Location "/xpra/">
		#ProxyPreserveHost On

		#RewriteEngine on
		#RewriteCond %{HTTP:UPGRADE} ^WebSocket$ [NC]
		#RewriteCond %{HTTP:CONNECTION} ^Upgrade$ [NC]
		#RewriteRule .* ws://xpra-container:10000/%{REQUEST_URI} [P,L]
		#RewriteCond %{REQUEST_URI} !^(.*)xpra(.*)$
		#RewriteRule ^/xpra/(.*)$ ws://xpra-container:10000/$1 [NC,L]
		#RewriteRule ^/xpra/(.*)$ http://xpra-container:10000/$1 [NC,L]

		RequestHeader set Xpra-Source-Port "10000"
		ProxyPass ws://xpra-container:10000/
		ProxyPassReverse ws://xpra-container:10000/

		ProxyPass http://xpra-container:10000/
		ProxyPassReverse http://xpra-container:10000/
	</Location>

    WSGIDaemonProcess flaskapp python-home="/opt/conda/envs/pyimagej"
	WSGIScriptAlias / /var/www/html/flask/app.wsgi
	
	<Directory /var/www/html/flask>
		WSGIProcessGroup flaskapp
		WSGIApplicationGroup %{GLOBAL}
		Require all granted
	</Directory>	

	Alias /static /var/www/html/flask/static

	<Directory /var/www/html/flask/static/>
		Require all granted
	</Directory>

    #RewriteEngine on
    #RewriteCond %{HTTP_HOST} ^bda\.as\.kent\.edu$

    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/flask.log combined
	#Header add Access-Control-Allow-Origin "http://xpra-container:10000/"
	#Header add Access-Control-Allow-Origin "http://bda.as.kent.edu:10000/"
	#Header add Access-Control-Allow-Origin "http://localhost:10000/"
</VirtualHost>